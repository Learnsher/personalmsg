<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>手機流程預覽</title>
    <!-- 載入Tailwind CSS作快速排版 --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 確保影片有聲播放（如果瀏覽器允許） */
        video {
            display: block;
        }

        /* 自定義圓形半透明背景按鈕樣式 */
        .control-button {
            background-color: rgba(255, 255, 255, 0.12); /* 半透明白色背景 */
            backdrop-filter: blur(6px); /* 輕微模糊效果 */
            border-radius: 9999px; /* 圓形 */
            width: 32px; /* 寬度 */
            height: 32px; /* 高度 */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* 輕微陰影 */
            transition: background-color 0.2s;
        }
        .control-button:hover {
            background-color: rgba(255, 255, 255, 0.7);
        }
    </style>
</head>
<body class="bg-gray-900 min-h-screen flex items-center justify-center p-4 font-sans">

    <!-- 縮放容器 --><div id="scaleContainer" class="flex items-center justify-center transition-transform duration-300 origin-center">
        <!-- 手機模擬框架 --><div id="imageContainer" class="w-[375px] h-[812px] bg-black rounded-[40px] shadow-2xl overflow-hidden border-[10px] border-gray-700 relative">
            <!-- 圖像顯示區域 --><img id="demoImage" src="1.png" alt="手機畫面" 
                 class="w-full h-full object-cover cursor-pointer">
        </div>
    </div>

    <!-- 影片彈窗 (Modal) --><div id="videoModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        
        <!-- 影片縮放容器 --><div id="videoScaleContainer" class="flex items-center justify-center transition-transform duration-300 origin-center">
            <!-- 影片容器 (寬度已修改為 340px) --><div class="relative bg-black rounded-lg shadow-xl w-[340px]">
            
            <!-- 關閉按鈕 (影片上方 40px，靠右對齊) --><button id="closeModal" class="absolute -top-[40px] right-0 text-white z-10 p-1 drop-shadow-lg hover:opacity-75 transition-opacity">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            
            <!-- 影片播放器 --><video id="demoVideo" 
                   class="w-full rounded-lg" 
                   src="5.mp4" 
                   loop 
                   preload="auto">
                你的瀏覽器不支持影片標籤。
            </video>

            <!-- 影片控制按鈕區域 (右下角) --><div id="videoControls" class="absolute bottom-3 left-3 flex space-x-2">
                <!-- Mute/Unmute 按鈕 --><button id="muteToggle" class="control-button">
                    <!-- SVG icon for unmute (正常喇叭) --><svg id="unmuteIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
                        <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
                        <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                    </svg>
                    <!-- SVG icon for mute (靜音喇叭帶斜線) --><svg id="muteIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 hidden">
                        <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
                        <line x1="23" y1="9" x2="17" y2="15"></line>
                        <line x1="17" y1="9" x2="23" y2="15"></line>
                    </svg>
                </button>
                
                <!-- Play/Pause 按鈕 --><button id="playPauseToggle" class="control-button">
                    <!-- SVG icon for play/pause --><svg id="playIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    <svg id="pauseIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 hidden">
                        <rect x="6" y="4" width="4" height="16"></rect>
                        <rect x="14" y="4" width="4" height="16"></rect>
                    </svg>
                </button>
            </div>

        </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const imageElement = document.getElementById('demoImage');
            const imageContainer = document.getElementById('imageContainer');
            const scaleContainer = document.getElementById('scaleContainer');
            const videoScaleContainer = document.getElementById('videoScaleContainer');
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('demoVideo');
            const closeModalBtn = document.getElementById('closeModal');
            const videoControls = document.getElementById('videoControls'); // 新增影片控制區域
            const muteToggle = document.getElementById('muteToggle');
            const playPauseToggle = document.getElementById('playPauseToggle');
            const muteIcon = document.getElementById('muteIcon');
            const unmuteIcon = document.getElementById('unmuteIcon'); // 正常喇叭圖標
            const playIcon = document.getElementById('playIcon');
            const pauseIcon = document.getElementById('pauseIcon');

            // 手機模擬框架的原始尺寸
            const phoneWidth = 375;
            const phoneHeight = 812;
            const padding = 32; // body 的 padding (p-4 = 16px * 2)

            // 計算並應用縮放
            function updateScale() {
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                
                // 計算可用空間（減去 padding）
                const availableWidth = windowWidth - padding;
                const availableHeight = windowHeight - padding;
                
                // 計算寬度和高度的縮放比例
                const scaleX = availableWidth / phoneWidth;
                const scaleY = availableHeight / phoneHeight;
                
                // 使用較小的縮放比例以確保內容完全可見，允許適度放大
                const scale = Math.min(scaleX, scaleY);
                
                // 應用縮放到手機模擬框架
                scaleContainer.style.transform = `scale(${scale})`;
                
                // 應用相同的縮放到影片容器
                if (videoScaleContainer) {
                    videoScaleContainer.style.transform = `scale(${scale})`;
                }
            }

            // 初始縮放
            updateScale();

            // 監聽窗口大小變化
            window.addEventListener('resize', updateScale);

            const images = ['1.png', '2.png', '3.png', '4.png'];
            const placeholders = [
                'https://placehold.co/375x812/cccccc/333333?text=1.png',
                'https://placehold.co/375x812/bbbbbb/333333?text=2.png',
                'https://placehold.co/375x812/aaaaaa/333333?text=3.png',
                'https://placehold.co/375x812/999999/333333?text=4.png (Scrollable)'
            ];
            
            let currentIndex = 0;

            // 更新播放/暫停按鈕圖標
            function updatePlayPauseIcon() {
                if (video.paused) {
                    playIcon.classList.remove('hidden');
                    pauseIcon.classList.add('hidden');
                } else {
                    playIcon.classList.add('hidden');
                    pauseIcon.classList.remove('hidden');
                }
            }

            // 更新靜音/取消靜音按鈕圖標
            function updateMuteIcon() {
                if (video.muted) {
                    muteIcon.classList.remove('hidden'); // 顯示靜音圖標
                    unmuteIcon.classList.add('hidden'); // 隱藏正常喇叭圖標
                } else {
                    muteIcon.classList.add('hidden'); // 隱藏靜音圖標
                    unmuteIcon.classList.remove('hidden'); // 顯示正常喇叭圖標
                }
            }

            function showVideoPopup() {
                modal.classList.remove('hidden');
                videoControls.classList.remove('hidden'); // 顯示影片控制按鈕
                
                // 重設靜音狀態為未靜音（用戶要求有聲）
                video.muted = false; 
                updateMuteIcon(); // 更新靜音圖標

                const playPromise = video.play();
                if (playPromise !== undefined) {
                    playPromise.catch(error => {
                        console.warn("影片自動播放（有聲）被瀏覽器阻止。", error);
                    }).finally(() => {
                        updatePlayPauseIcon(); // 無論是否自動播放成功，都更新圖標
                    });
                } else {
                    updatePlayPauseIcon(); // 無 playPromise，直接更新圖標
                }
            }

            function hideVideoPopup() {
                modal.classList.add('hidden');
                videoControls.classList.add('hidden'); // 隱藏影片控制按鈕
                video.pause();
                video.currentTime = 0;
            }

            function nextImage() {
                currentIndex = (currentIndex + 1) % images.length;
                imageElement.src = images[currentIndex];

                // 重設滾動位置到頂部
                imageContainer.scrollTop = 0; 

                if (currentIndex === 3) { // 4.png
                    imageContainer.classList.remove('overflow-hidden');
                    imageContainer.classList.add('overflow-y-auto');
                    imageElement.classList.remove('h-full', 'object-cover');
                    imageElement.classList.add('object-top');
                    imageElement.style.height = 'auto';
                } else { // 1.png, 2.png, 3.png
                    imageContainer.classList.add('overflow-hidden');
                    imageContainer.classList.remove('overflow-y-auto');
                    imageElement.classList.add('h-full', 'object-cover');
                    imageElement.classList.remove('object-top');
                    imageElement.style.height = '';
                }
                
                if (currentIndex === 2) { // 3.png
                    showVideoPopup();
                }
            }

            // --- 綁定事件監聽器 ---
            imageElement.addEventListener('click', nextImage);
            closeModalBtn.addEventListener('click', hideVideoPopup);
            modal.addEventListener('click', (event) => {
                if (event.target === modal) {
                    hideVideoPopup();
                }
            });

            // 靜音/取消靜音按鈕
            muteToggle.addEventListener('click', () => {
                video.muted = !video.muted;
                updateMuteIcon();
            });

            // 播放/暫停按鈕
            playPauseToggle.addEventListener('click', () => {
                if (video.paused) {
                    video.play();
                } else {
                    video.pause();
                }
                updatePlayPauseIcon();
            });

            // 監聽影片實際播放狀態變化
            video.addEventListener('play', updatePlayPauseIcon);
            video.addEventListener('pause', updatePlayPauseIcon);
            video.addEventListener('volumechange', updateMuteIcon); // 監聽音量變化以更新靜音圖標

            imageElement.addEventListener('error', () => {
                const currentSrc = imageElement.getAttribute('src');
                if (currentSrc && !currentSrc.startsWith('https://placehold.co')) {
                    console.error(`無法載入圖片: ${images[currentIndex]}。顯示佔位圖。`);
                    imageElement.src = placeholders[currentIndex];
                } else if (!currentSrc) {
                    console.error(`圖片 src 為空。顯示佔位圖。`);
                    imageElement.src = placeholders[currentIndex];
                }
            });

            video.addEventListener('error', (e) => {
                console.error("無法載入影片 5.mp4");
                const videoContainer = video.parentElement;
                if (videoContainer) {
                    video.remove();
                    videoContainer.innerHTML += '<div class="text-white p-8 text-center">影片載入失敗 (5.mp4)</div>';
                    videoControls.classList.add('hidden'); // 影片失敗時隱藏控制按鈕
                }
            });
        });
    </script>
</body>
</html>